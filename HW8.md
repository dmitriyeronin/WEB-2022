# Обеспечение безопасности студсайта inbicst.ru

## XSS

При тестировании простейших запросов типа "><script>alert(1)</script>, было обнаружено, что происходит санитизация для некоторых символов. Символ " заменяется на &quot, что не даёт выполнить простейшую XSS-инъекцию, однако символы ;<> не преобразуются.

Защита:
- добавить санитаризацию всех остальных служебных символов
- разрешить вводить в поля поиска только буквы и цифры

## Социальная инженерия

Для неавторизованного пользователя доступны личные контакты некоторых представителей студсовета, что даёт возможность осуществления атаки с целью получения несанкционированного доступа например к персональными данным студентов (а их немало).

Защита:
- минимизировать данные, оставить только один контакт для вопросов абитуриентов, контакты остальных людей сделать доступными только для авторизованных пользователей
- реализовать общение с абитуриентами через специальную форму на сайте/бота в мессенджере

## Вредоносное ПО

Интерфейс сайта позволяет загружать учебные материалы в общую библиотеку, что теоретически даёт возможность загрузки заражённых файлов.

Защита:
- Проверка формата файлов, разрешить загружать только PDF, EPUB, FB2, JPEG и т.д.
- В случае необходимости загружать исполняемые файлы (например полезные программы) сканировать их на наличие вирусов, червей и троянов (например VirusTotal)

## Несанкционированный доступ по SSH

При сканировании IP адреса сетевым сканером nmap было обнаружен открытый 22 про с работающим на нем SSH клиентом OpenSSH версии 7.9p1. Для данной версии нет общеизвестных уязвимостей, хотя и свежей её назвать нельзя. Используется протокол второй версии, что хорошо.

Для обеспечения безопасного доступа более безопасного доступа по SSH необходимо:
- перенести службу с 22 порта на какой-либо ещё, чтобы уменьшить вероятность случайного обнаружения
- настроить fail2ban
- оставить возможность входа только с IP адресов админов
- отключение авторизации на стороне клиента
- вместо доступа по паролю настроить доступ по ключу

## CSRF

Защита от CSRF-атак реализована при помощи токенов anti-CSRF.

## Авторизация

Не храним пароли в открытом виде, хэшируем их с солью (например bcrypt, используемый для этого по умолчанию в PHP). Двухфакторная авторизация думаю уже лишнее, всё же суперсекретного ничего не храним.

## MITM

Настраиваем TLS шифрование трафика, сертификаты можно использовать от Let’s Encript.

## Управление уязвимости

Автоматизируем процесс сканирования сервера сканером безопасности и регулярно патчим/обновляем уязвимые компоненты. Делаем это, когда меньше всего пользователей, чтоб не перегружать.
Общеизвестных уязвимостей обнаружено не было, но версии Nginx и OpenSSH используются далеко не самые свежие.

## Доступность

Судя по IP адресу, настоящий момент хостинг находится в Германии, что в свете политических событий последнего полугода может внезапно стать проблемой. Стоит быть к этому готовым и иметь бэкапы.




# Обеспечение безопасности учебного сервсиса

Применительно к созданному серверу актуальны те же типы атак.

Дополнительно возникает необходимость защиты БД Redis.
Надо настроит авторизованный доступ, наилучшим вариантом будет сгенерированный ключ при помощи OpenSSL.
Помимо этого можно настроить переименование «опасных» команд (FLUSHDB, FLUSHALL, KEYS, PEXPIRE, DEL, CONFIG, SHUTDOWN и т. д.)

Стоит настроит и функции безопасности в Kafka, а именно TLS шифрование передаваемых данных, SASL-аутентификацию и списки управления доступом.
